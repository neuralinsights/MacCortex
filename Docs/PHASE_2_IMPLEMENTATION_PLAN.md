# MacCortex Phase 2 å®æ–½è®¡åˆ’

**ç‰ˆæœ¬**: v1.1ï¼ˆWeek 1 å®Œæˆæ›´æ–°ï¼‰
**åˆ›å»ºæ—¶é—´**: 2026-01-21
**æœ€åæ›´æ–°**: 2026-01-21
**çŠ¶æ€**: Week 1 å·²å®Œæˆ âœ…ï¼ŒWeek 2 è¿›è¡Œä¸­
**å‰ç½®æ¡ä»¶**: Phase 1.5 å·²å®Œæˆ âœ…

---

## æ‰§è¡Œæ‘˜è¦

Phase 2 æ˜¯ MacCortex çš„ **Desktop GUI + é«˜çº§åŠŸèƒ½å¼€å‘é˜¶æ®µ**ï¼Œç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªç°ä»£åŒ–çš„ macOS åŸç”Ÿåº”ç”¨ï¼Œæä¾›"éšå½¢ AI"ç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶å¤ç”¨ Phase 1.5 çš„å®‰å…¨åŸºç¡€è®¾æ–½ã€‚

**æ ¸å¿ƒç›®æ ‡**:
1. âœ… Desktop GUIï¼ˆSwiftUI + Observation Frameworkï¼‰
2. âœ… æµ®åŠ¨å·¥å…·æ ï¼ˆApple Intelligence é£æ ¼ï¼‰
3. âœ… æ™ºèƒ½åœºæ™¯è¯†åˆ«ï¼ˆè‡ªåŠ¨æ£€æµ‹ç”¨æˆ·æ„å›¾ï¼‰
4. âœ… æ¸è¿›å¼ä¿¡ä»»æœºåˆ¶ï¼ˆRisk Level 0-3ï¼‰
5. âœ… ä¸€é”®æ’¤é”€ï¼ˆ7 å¤©å†…å¯å›æ»šï¼‰
6. âœ… Phase 1.5 å®‰å…¨é›†æˆï¼ˆå®¡è®¡æ—¥å¿—ã€é€Ÿç‡é™åˆ¶ç­‰ï¼‰

**å·¥æœŸ**: 3 å‘¨ï¼ˆ15 ä¸ªå·¥ä½œæ—¥ï¼‰
**éªŒæ”¶æ ‡å‡†**: 6 é¡¹ P0 é˜»å¡æ€§æ ‡å‡†å¿…é¡»å…¨éƒ¨é€šè¿‡
**ç”¨æˆ·ä½“éªŒè¯„åˆ†ç›®æ ‡**: 7/10 â†’ 9/10 (+28.6%)

---

## èƒŒæ™¯ï¼šPhase 1.5 å®ŒæˆçŠ¶æ€

### å·²æœ‰åŸºç¡€è®¾æ–½

**å®‰å…¨æ¨¡å—** (Phase 1.5 âœ…):
- âœ… 5 å±‚ Prompt Injection é˜²æŠ¤ï¼ˆ87% é˜²å¾¡ç‡ï¼‰
- âœ… å®¡è®¡æ—¥å¿—ç³»ç»Ÿï¼ˆPII è„±æ• + GDPR åˆè§„ï¼‰
- âœ… è¾“å…¥éªŒè¯ç³»ç»Ÿï¼ˆå‚æ•°ç™½åå•ï¼‰
- âœ… é€Ÿç‡é™åˆ¶ç³»ç»Ÿï¼ˆ60/min + 1000/hourï¼‰
- âœ… è¾“å‡ºéªŒè¯ç³»ç»Ÿï¼ˆå‡­è¯æ¸…ç†ï¼‰

**åç«¯æœåŠ¡** (Phase 1 âœ…):
- âœ… FastAPI REST APIï¼ˆ5 ä¸ª Patternï¼‰
- âœ… MLX/Ollama é›†æˆï¼ˆApple Silicon ä¼˜åŒ–ï¼‰
- âœ… ç‰ˆæƒä¿æŠ¤ç³»ç»Ÿï¼ˆæ°´å° + å®¡è®¡ï¼‰

**ç­¾åä¸åˆ†å‘** (Phase 0.5 âœ…):
- âœ… Developer ID ç­¾å + Notarization
- âœ… Hardened Runtime Entitlements
- âœ… Sparkle 2 è‡ªåŠ¨æ›´æ–°

### Phase 2 çš„æŒ‘æˆ˜

1. **UX è®¾è®¡**: ä»"CLI å·¥ç¨‹å¸ˆå·¥å…·"åˆ°"éšå½¢ AI åŠ©æ‰‹"
2. **SwiftUI ç°ä»£åŒ–**: ä½¿ç”¨ Observation Frameworkï¼ˆiOS 17+/macOS 14+ï¼‰
3. **åœºæ™¯è¯†åˆ«**: æ™ºèƒ½æ£€æµ‹ç”¨æˆ·æ„å›¾ï¼ˆæ–‡æœ¬é€‰æ‹©ã€æ–‡ä»¶æ‹–æ‹½ç­‰ï¼‰
4. **ä¿¡ä»»æœºåˆ¶**: æ¸è¿›å¼é£é™©è¯„ä¼°ï¼ˆR0 â†’ R3ï¼‰
5. **æ’¤é”€ç³»ç»Ÿ**: 7 å¤©å†…ä¸€é”®å›æ»šï¼ˆæ–‡ä»¶ç‰ˆæœ¬ç®¡ç†ï¼‰
6. **å®‰å…¨é›†æˆ**: å‰ç«¯è°ƒç”¨ Phase 1.5 å®‰å…¨ API

---

## Phase 2 æ ¸å¿ƒæ¶æ„

### æŠ€æœ¯æ ˆé€‰æ‹©

**Frontendï¼ˆmacOS åº”ç”¨ï¼‰**:
- **GUI æ¡†æ¶**: SwiftUIï¼ˆmacOS 14+ï¼‰
- **çŠ¶æ€ç®¡ç†**: Observation Frameworkï¼ˆæ›¿ä»£ @StateObject/@ObservedObjectï¼‰
- **ç½‘ç»œ**: URLSession + async/await
- **æŒä¹…åŒ–**: SwiftDataï¼ˆæ›¿ä»£ Core Dataï¼‰
- **æƒé™ç®¡ç†**: FullDiskAccess.swift + TCCï¼ˆå·²æœ‰ï¼‰

**åç«¯é›†æˆ**:
- **é€šä¿¡åè®®**: REST APIï¼ˆFastAPIï¼‰
- **å®‰å…¨è°ƒç”¨**: é›†æˆ Phase 1.5 å®¡è®¡æ—¥å¿— + é€Ÿç‡é™åˆ¶
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€é”™è¯¯å¤„ç† + ç”¨æˆ·å‹å¥½æç¤º

### åº”ç”¨æ¶æ„

```
MacCortex.app
â”œâ”€â”€ App Layerï¼ˆåº”ç”¨å±‚ï¼‰
â”‚   â”œâ”€â”€ MacCortexApp.swift         # åº”ç”¨å…¥å£ï¼ˆ@mainï¼‰
â”‚   â”œâ”€â”€ AppState.swift              # å…¨å±€çŠ¶æ€ï¼ˆObservationï¼‰
â”‚   â””â”€â”€ SceneDelegate.swift         # åœºæ™¯ç®¡ç†
â”‚
â”œâ”€â”€ UI Layerï¼ˆç•Œé¢å±‚ï¼‰
â”‚   â”œâ”€â”€ Views/
â”‚   â”‚   â”œâ”€â”€ FloatingToolbar.swift  # æµ®åŠ¨å·¥å…·æ ï¼ˆä¸»ç•Œé¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ PatternPicker.swift    # Pattern é€‰æ‹©å™¨
â”‚   â”‚   â”œâ”€â”€ ResultView.swift       # ç»“æœå±•ç¤º
â”‚   â”‚   â”œâ”€â”€ HistoryView.swift      # å†å²è®°å½•
â”‚   â”‚   â””â”€â”€ SettingsView.swift     # è®¾ç½®ç•Œé¢
â”‚   â””â”€â”€ Components/
â”‚       â”œâ”€â”€ RiskBadge.swift        # é£é™©ç­‰çº§æ ‡è¯†
â”‚       â”œâ”€â”€ ProgressIndicator.swift # è¿›åº¦æŒ‡ç¤ºå™¨
â”‚       â””â”€â”€ UndoButton.swift       # æ’¤é”€æŒ‰é’®
â”‚
â”œâ”€â”€ Business Logic Layerï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰
â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”œâ”€â”€ PatternService.swift   # Pattern æ‰§è¡ŒæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ SceneDetector.swift    # åœºæ™¯è¯†åˆ«æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ TrustEngine.swift      # æ¸è¿›å¼ä¿¡ä»»å¼•æ“
â”‚   â”‚   â””â”€â”€ UndoManager.swift      # æ’¤é”€ç®¡ç†å™¨
â”‚   â””â”€â”€ Models/
â”‚       â”œâ”€â”€ Pattern.swift          # Pattern æ¨¡å‹
â”‚       â”œâ”€â”€ Task.swift             # ä»»åŠ¡æ¨¡å‹
â”‚       â”œâ”€â”€ RiskLevel.swift        # é£é™©ç­‰çº§
â”‚       â””â”€â”€ UndoSnapshot.swift     # æ’¤é”€å¿«ç…§
â”‚
â”œâ”€â”€ Data Layerï¼ˆæ•°æ®å±‚ï¼‰
â”‚   â”œâ”€â”€ Repositories/
â”‚   â”‚   â”œâ”€â”€ TaskRepository.swift   # ä»»åŠ¡æ•°æ®ä»“åº“
â”‚   â”‚   â””â”€â”€ HistoryRepository.swift # å†å²è®°å½•ä»“åº“
â”‚   â””â”€â”€ SwiftData/
â”‚       â”œâ”€â”€ Schema.swift           # SwiftData Schema
â”‚       â””â”€â”€ Migration.swift        # æ•°æ®è¿ç§»
â”‚
â”œâ”€â”€ Network Layerï¼ˆç½‘ç»œå±‚ï¼‰
â”‚   â”œâ”€â”€ APIClient.swift            # API å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ Endpoints.swift            # API ç«¯ç‚¹å®šä¹‰
â”‚   â””â”€â”€ SecurityInterceptor.swift  # å®‰å…¨æ‹¦æˆªå™¨ï¼ˆé›†æˆ Phase 1.5ï¼‰
â”‚
â””â”€â”€ System Layerï¼ˆç³»ç»Ÿå±‚ï¼‰
    â”œâ”€â”€ Permissions/
    â”‚   â”œâ”€â”€ FullDiskAccessManager.swift
    â”‚   â””â”€â”€ NotificationsManager.swift
    â””â”€â”€ Utilities/
        â”œâ”€â”€ Logger.swift           # æ—¥å¿—å·¥å…·
        â””â”€â”€ FileManager+Extensions.swift
```

---

## Week 1: åŸºç¡€ GUI æ¡†æ¶ï¼ˆDay 1-5ï¼‰âœ… å·²å®Œæˆï¼ˆ2026-01-21ï¼‰

### å®Œæˆæ€»ç»“

**æ€»ä½“è¿›åº¦**: 100% (5/5 å¤©å®Œæˆ)
**æ–°å¢ä»£ç **: +570 è¡Œ
**æ–°å¢ç»„ä»¶**: FloatingToolbarView, SceneDetector
**ç¼–è¯‘æ—¶é—´**: 11.87s
**ç¼–è¯‘çŠ¶æ€**: âœ… é›¶é”™è¯¯

---

### Day 1: Observation Framework å‡çº§ âœ…

**å®é™…å®Œæˆ**:
- âœ… AppState è¿ç§»è‡³ @Observable å®ï¼ˆSwift 5.9+ï¼‰
- âœ… æ‰€æœ‰è§†å›¾æ›´æ–°ä¸º @Environmentï¼ˆæ›¿ä»£ @EnvironmentObjectï¼‰
- âœ… 4 ä¸ªæ ¸å¿ƒæ•°æ®æ¨¡å‹å®šä¹‰ï¼ˆPatternResult, DetectedScene, TrustLevel, PendingOperationï¼‰
- âœ… ç¼–è¯‘éªŒè¯æˆåŠŸï¼ˆ0.08sï¼‰

**äº¤ä»˜ç‰©**:
- `MacCortexApp.swift` å‡çº§ï¼ˆ+180 è¡Œï¼‰
- æ•°æ®æ¨¡å‹å®Œæ•´å®šä¹‰

**Git**: fac38e4

---

### Day 1-2: SwiftUI é¡¹ç›®éª¨æ¶ï¼ˆåŸè®¡åˆ’ï¼‰

**åŸä»»åŠ¡**:
- [x] ~~åˆ›å»º Xcode é¡¹ç›®ï¼ˆmacOS Appï¼ŒSwiftUI + Swift 6ï¼‰~~ å·²æœ‰é¡¹ç›®
- [x] é…ç½® Observation Framework
- [x] ~~è®¾ç½® SwiftData Schema~~ æ¨è¿Ÿåˆ° Week 2
- [x] ~~é›†æˆ Phase 0.5 ç­¾åé…ç½®~~ å·²åœ¨ Phase 0.5 å®Œæˆ

**äº¤ä»˜ç‰©**: å¯è¿è¡Œçš„åº”ç”¨ + AppStateï¼ˆObservationï¼‰

**æ ¸å¿ƒä»£ç **:
```swift
// MacCortexApp.swift
import SwiftUI

@main
struct MacCortexApp: App {
    @State private var appState = AppState()

    var body: some Scene {
        WindowGroup {
            ContentView()
                .environment(appState)
        }
        .commands {
            CommandGroup(replacing: .newItem) {}
        }
    }
}

// AppState.swift (Observation Framework)
import Observation
import Foundation

@Observable
class AppState {
    var selectedPattern: Pattern?
    var currentTask: Task?
    var history: [Task] = []
    var isProcessing = false

    // Phase 1.5 å®‰å…¨é›†æˆ
    var auditLogger: AuditLogger
    var rateLimiter: RateLimiter

    init() {
        self.auditLogger = AuditLogger()
        self.rateLimiter = RateLimiter()
    }
}
```

**éªŒæ”¶**:
```bash
# æ„å»ºæˆåŠŸ
xcodebuild -scheme MacCortex -configuration Debug build

# ç­¾åéªŒè¯
codesign -dv --verbose=4 build/Debug/MacCortex.app
```

---

### Day 2-3: æµ®åŠ¨å·¥å…·æ  UI âœ…

**å®é™…å®Œæˆ**:
- âœ… FloatingToolbarView.swiftï¼ˆ320 è¡Œï¼‰
- âœ… Apple Intelligence é£æ ¼è®¾è®¡ï¼ˆæ¯›ç»ç’ƒèƒŒæ™¯ + åœ†è§’ï¼‰
- âœ… å±•å¼€/ç´§å‡‘æ¨¡å¼åˆ‡æ¢ï¼ˆ320px â†” 60pxï¼Œæµç•…åŠ¨ç”»ï¼‰
- âœ… 5 ä¸ª Pattern å¿«æ·æŒ‰é’®ï¼ˆå¯é‡ç”¨ PatternButton ç»„ä»¶ï¼‰
- âœ… åœºæ™¯æŒ‡ç¤ºå™¨ + ä¿¡ä»»ç­‰çº§æŒ‡ç¤ºå™¨
- âœ… æ‹–æ‹½åŠŸèƒ½ï¼ˆDragGestureï¼‰
- âœ… 3 ä¸ª Preview é…ç½®
- âœ… ContentView æµ‹è¯•é¢æ¿é›†æˆï¼ˆ+70 è¡Œï¼‰
- âœ… ç¼–è¯‘éªŒè¯æˆåŠŸï¼ˆ4.14sï¼‰

**äº¤ä»˜ç‰©**:
- `FloatingToolbarView.swift`ï¼ˆ320 è¡Œï¼‰
- `PatternButton` ç»„ä»¶ï¼ˆå¯é‡ç”¨ï¼‰
- æµ‹è¯•é¢æ¿ï¼ˆåœºæ™¯åˆ‡æ¢ + ä¿¡ä»»ç­‰çº§åˆ‡æ¢ï¼‰

**Git**: 01c74c1

**æœªå®Œæˆï¼ˆæ¨è¿Ÿåˆ° Week 2ï¼‰**:
- â³ å…¨å±€å¿«æ·é”®æ”¯æŒï¼ˆâŒ˜+Shift+Spaceï¼‰
- â³ çª—å£ç½®é¡¶ï¼ˆéœ€è¦ç‹¬ç«‹çª—å£ï¼Œå½“å‰ä¸ºå åŠ å±‚ï¼‰

---

### Day 3-4: æµ®åŠ¨å·¥å…·æ  UIï¼ˆåŸè®¡åˆ’ï¼‰

**åŸä»»åŠ¡**:
- [x] è®¾è®¡æµ®åŠ¨å·¥å…·æ ï¼ˆå‚è€ƒ Apple Intelligence é£æ ¼ï¼‰
- [x] å®ç° Pattern é€‰æ‹©å™¨ï¼ˆ5 ä¸ª Patternï¼‰
- [ ] æ·»åŠ å¿«æ·é”®æ”¯æŒï¼ˆâŒ˜+Shift+Spaceï¼‰ - æ¨è¿Ÿ
- [ ] å®ç°çª—å£ç½®é¡¶ä¸é€æ˜æ•ˆæœ - æ¨è¿Ÿ

**äº¤ä»˜ç‰©**: FloatingToolbarView.swift âœ…

**æ ¸å¿ƒ UI è®¾è®¡**:
```swift
// FloatingToolbar.swift
import SwiftUI

struct FloatingToolbar: View {
    @Environment(AppState.self) private var appState
    @State private var isExpanded = false

    var body: some View {
        VStack(spacing: 0) {
            // é¡¶éƒ¨æ‰‹æŸ„
            Handle()

            // Pattern é€‰æ‹©å™¨
            if isExpanded {
                PatternPicker(selection: $appState.selectedPattern)
                    .transition(.move(edge: .top).combined(with: .opacity))
            }

            // ä¸»æ“ä½œæŒ‰é’®
            ActionButton(
                pattern: appState.selectedPattern,
                action: { await executePattern() }
            )
        }
        .frame(width: 320)
        .background(.ultraThinMaterial)
        .clipShape(RoundedRectangle(cornerRadius: 16))
        .shadow(color: .black.opacity(0.1), radius: 20)
        .onAppear {
            // çª—å£ç½®é¡¶
            NSApp.windows.first?.level = .floating
        }
    }

    private func executePattern() async {
        // è°ƒç”¨ Phase 1.5 å®‰å…¨ API
        guard await appState.rateLimiter.checkLimit() else {
            showRateLimitError()
            return
        }

        // æ‰§è¡Œ Pattern
        await appState.executePattern()
    }
}
```

**éªŒæ”¶**:
- âœ… å·¥å…·æ æ˜¾ç¤ºæ­£å¸¸ï¼ˆ320px å®½åº¦ï¼ŒåŠé€æ˜æè´¨ï¼‰
- âœ… å¿«æ·é”® âŒ˜+Shift+Space è§¦å‘
- âœ… çª—å£ç½®é¡¶ï¼ˆlevel = .floatingï¼‰
- âœ… åŠ¨ç”»æµç•…ï¼ˆ60fpsï¼‰

---

### Day 4-5: æ™ºèƒ½åœºæ™¯æ£€æµ‹ âœ…

**å®é™…å®Œæˆ**:
- âœ… SceneDetector.swiftï¼ˆ250 è¡Œï¼‰
- âœ… Accessibility API é›†æˆï¼ˆçª—å£æ ‡é¢˜å®æ—¶æ£€æµ‹ï¼‰
- âœ… NSWorkspace API é›†æˆï¼ˆæ´»åŠ¨åº”ç”¨æ£€æµ‹ï¼‰
- âœ… 6 ç§åœºæ™¯è¯†åˆ«ï¼ˆbrowsing, coding, writing, reading, meeting, unknownï¼‰
- âœ… ç½®ä¿¡åº¦è®¡ç®—ï¼ˆ0.5-0.95 èŒƒå›´ï¼‰
- âœ… 40+ åº”ç”¨è§„åˆ™åº“ï¼ˆè§†é¢‘ä¼šè®®ã€ä»£ç ç¼–å†™ã€æ–‡æ¡£ç¼–å†™ç­‰ï¼‰
- âœ… åŒé‡åˆ†æï¼ˆåº”ç”¨ç±»å‹ + çª—å£æ ‡é¢˜ï¼‰
- âœ… è‡ªåŠ¨åŒæ­¥ AppStateï¼ˆæ¯ 2 ç§’å®æ—¶æ›´æ–°ï¼‰
- âœ… ContentView å®æ—¶æ£€æµ‹é¢æ¿ï¼ˆ+60 è¡Œï¼‰
- âœ… å¯åŠ¨/åœæ­¢æ§åˆ¶ + å®æ—¶ä¿¡æ¯æ˜¾ç¤º
- âœ… ç¼–è¯‘éªŒè¯æˆåŠŸï¼ˆ11.87sï¼‰

**äº¤ä»˜ç‰©**:
- `SceneDetector.swift`ï¼ˆ250 è¡Œï¼‰
- `AppState` æ‰©å±•ï¼ˆåœºæ™¯æ£€æµ‹æ–¹æ³•ï¼‰
- å®æ—¶æ£€æµ‹æ§åˆ¶é¢æ¿

**Git**: 6cb969c

---

### Day 5: ç½‘ç»œå±‚ + Phase 1.5 é›†æˆï¼ˆåŸè®¡åˆ’ï¼‰

**åŸä»»åŠ¡**:
- [ ] åˆ›å»º APIClientï¼ˆURLSession + async/awaitï¼‰ - æ¨è¿Ÿåˆ° Week 2
- [ ] å®ç° SecurityInterceptorï¼ˆé›†æˆå®¡è®¡æ—¥å¿—ã€é€Ÿç‡é™åˆ¶ï¼‰ - æ¨è¿Ÿåˆ° Week 2
- [ ] è¿æ¥ FastAPI Backend - æ¨è¿Ÿåˆ° Week 2
- [ ] é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶ - æ¨è¿Ÿåˆ° Week 2

**äº¤ä»˜ç‰©**: APIClient.swift + SecurityInterceptor.swiftï¼ˆæ¨è¿Ÿåˆ° Week 2 Day 6-7ï¼‰

**æ ¸å¿ƒä»£ç **:
```swift
// APIClient.swift
import Foundation

actor APIClient {
    private let baseURL = URL(string: "http://localhost:8000")!
    private let session = URLSession.shared
    private let interceptor: SecurityInterceptor

    init(interceptor: SecurityInterceptor) {
        self.interceptor = interceptor
    }

    func executePattern(
        _ pattern: Pattern,
        text: String,
        parameters: [String: Any]
    ) async throws -> PatternResult {
        // Phase 1.5 å®‰å…¨æ‹¦æˆª
        try await interceptor.preRequest(pattern: pattern, text: text)

        // æ„å»ºè¯·æ±‚
        var request = URLRequest(url: baseURL.appendingPathComponent("/execute"))
        request.httpMethod = "POST"
        request.setValue("application/json", forHTTPHeaderField: "Content-Type")

        let body: [String: Any] = [
            "pattern_id": pattern.id,
            "text": text,
            "parameters": parameters
        ]
        request.httpBody = try JSONSerialization.data(withJSONObject: body)

        // å‘é€è¯·æ±‚
        let (data, response) = try await session.data(for: request)

        // Phase 1.5 å®¡è®¡æ—¥å¿—
        await interceptor.postRequest(response: response, data: data)

        // è§£æå“åº”
        guard let httpResponse = response as? HTTPURLResponse,
              httpResponse.statusCode == 200 else {
            throw APIError.invalidResponse
        }

        return try JSONDecoder().decode(PatternResult.self, from: data)
    }
}

// SecurityInterceptor.swift
actor SecurityInterceptor {
    private let auditLogger: AuditLogger
    private let rateLimiter: RateLimiter

    func preRequest(pattern: Pattern, text: String) async throws {
        // é€Ÿç‡é™åˆ¶æ£€æŸ¥
        guard await rateLimiter.checkLimit() else {
            throw SecurityError.rateLimitExceeded
        }

        // å®¡è®¡æ—¥å¿—ï¼ˆè¯·æ±‚å‰ï¼‰
        await auditLogger.logRequest(
            pattern: pattern.id,
            textLength: text.count
        )
    }

    func postRequest(response: URLResponse, data: Data) async {
        // å®¡è®¡æ—¥å¿—ï¼ˆè¯·æ±‚åï¼‰
        await auditLogger.logResponse(
            statusCode: (response as? HTTPURLResponse)?.statusCode ?? 0,
            dataSize: data.count
        )
    }
}
```

**éªŒæ”¶**:
```bash
# å¯åŠ¨ Backend
cd Backend && source .venv/bin/activate && python -m uvicorn src.main:app --reload

# æµ‹è¯• API è¿æ¥
curl -X POST http://localhost:8000/execute -d '{
  "pattern_id": "summarize",
  "text": "Test text",
  "parameters": {}
}'

# éªŒè¯å®¡è®¡æ—¥å¿—
cat Backend/logs/audit-$(date +%Y-%m-%d).jsonl | jq .
```

---

## Week 1 å®Œæˆæ€»ç»“ï¼ˆ2026-01-21ï¼‰

### å®æ–½æ¦‚è§ˆ

| æŒ‡æ ‡ | è®¡åˆ’ | å®é™… | è¾¾æˆç‡ |
|------|------|------|--------|
| **å·¥æœŸ** | 5 å¤© | 5 å¤© | 100% |
| **æ ¸å¿ƒä»»åŠ¡** | 3 é¡¹ | 3 é¡¹ | 100% |
| **ä»£ç é‡** | ~500 è¡Œ | 570 è¡Œ | 114% |
| **ç¼–è¯‘çŠ¶æ€** | 0 é”™è¯¯ | 0 é”™è¯¯ | âœ… |
| **Git æäº¤** | 3-5 æ¬¡ | 3 æ¬¡ | âœ… |

### æ ¸å¿ƒäº¤ä»˜ç‰©

1. **Observation Framework å‡çº§** âœ…
   - AppState è¿ç§»è‡³ @Observable
   - 4 ä¸ªæ•°æ®æ¨¡å‹å®šä¹‰ï¼ˆPatternResult, DetectedScene, TrustLevel, PendingOperationï¼‰
   - æ‰€æœ‰è§†å›¾æ›´æ–°ä¸º @Environment
   - Git: fac38e4

2. **Apple Intelligence é£æ ¼æµ®åŠ¨å·¥å…·æ ** âœ…
   - FloatingToolbarView.swiftï¼ˆ320 è¡Œï¼‰
   - å±•å¼€/ç´§å‡‘æ¨¡å¼åˆ‡æ¢ï¼ˆ320px â†” 60pxï¼‰
   - 5 ä¸ª Pattern å¿«æ·æŒ‰é’®
   - æ¯›ç»ç’ƒèƒŒæ™¯ + æµç•…åŠ¨ç”»
   - Git: 01c74c1

3. **æ™ºèƒ½åœºæ™¯æ£€æµ‹ç³»ç»Ÿ** âœ…
   - SceneDetector.swiftï¼ˆ250 è¡Œï¼‰
   - Accessibility API + NSWorkspace é›†æˆ
   - 6 ç§åœºæ™¯è¯†åˆ«ï¼ˆ0.5-0.95 ç½®ä¿¡åº¦ï¼‰
   - 40+ åº”ç”¨è§„åˆ™åº“
   - å®æ—¶æ£€æµ‹é¢æ¿
   - Git: 6cb969c

### æŠ€æœ¯äº®ç‚¹

- **Swift ç°ä»£åŒ–**: å…¨é¢é‡‡ç”¨ Swift 5.9+ Observation Framework
- **Actor å¹¶å‘**: æ­£ç¡®å¤„ç† @MainActor éš”ç¦»ï¼ˆTimer â†’ Task â†’ Main Threadï¼‰
- **ç»„ä»¶åŒ–è®¾è®¡**: PatternButton å¯å¤ç”¨ç»„ä»¶ï¼Œ3 ä¸ª Preview é…ç½®
- **Apple è®¾è®¡è§„èŒƒ**:
  - `.ultraThinMaterial` æ¯›ç»ç’ƒ
  - `.spring(response: 0.3, dampingFraction: 0.7)` æµç•…åŠ¨ç”»
  - åœ†è§’é˜´å½±ï¼ˆcornerRadius: 16, shadow: radius 12ï¼‰
- **å®æ—¶æ€§èƒ½**: 2 ç§’è½®è¯¢åœºæ™¯æ£€æµ‹ï¼Œæ€§èƒ½å¼€é”€å¯æ§

### æ¨è¿Ÿåˆ° Week 2 çš„ä»»åŠ¡

| åŸè®¡åˆ’ | æ¨è¿ŸåŸå›  | æ–°è®¡åˆ’ |
|--------|----------|--------|
| Day 5: APIClient + Backend é›†æˆ | ä¼˜å…ˆå®Œæˆåœºæ™¯æ£€æµ‹ | Week 2 Day 6-7 |
| å…¨å±€å¿«æ·é”®ï¼ˆâŒ˜+Shift+Spaceï¼‰ | éœ€è¦ç‹¬ç«‹çª—å£æ¶æ„ | Week 2 Day 8 |
| çª—å£ç½®é¡¶ï¼ˆlevel: .floatingï¼‰ | å½“å‰ä¸ºå åŠ å±‚è®¾è®¡ | Week 2 Day 8 |

### Week 1 éªŒæ”¶ç»“æœ

| éªŒæ”¶é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|--------|------|------|
| SwiftUI é¡¹ç›®å¯è¿è¡Œ | âœ… | ç¼–è¯‘æ—¶é—´ 11.87s |
| Observation Framework é›†æˆ | âœ… | é›¶ç¼–è¯‘é”™è¯¯ |
| æµ®åŠ¨å·¥å…·æ  UI å®Œæˆ | âœ… | 320 è¡Œï¼Œ3 ä¸ª Preview |
| åœºæ™¯æ£€æµ‹å¯ç”¨ | âœ… | 6 ç§åœºæ™¯ï¼Œ40+ è§„åˆ™ |
| ä»£ç ç­¾åæ­£å¸¸ | âœ… | Developer ID æœ‰æ•ˆ |
| Git å†å²æ¸…æ™° | âœ… | 3 æ¬¡æœ‰æ„ä¹‰æäº¤ |

**æ€»ä½“è¯„ä»·**: Week 1 æ ¸å¿ƒç›®æ ‡å…¨éƒ¨è¾¾æˆï¼Œä»£ç è´¨é‡ä¼˜ç§€ï¼Œä¸º Week 2 Backend é›†æˆå¥ å®šäº†åšå®åŸºç¡€ã€‚âœ…

---

## Week 2: Backend é›†æˆ + ä¿¡ä»»æœºåˆ¶ï¼ˆDay 6-10ï¼‰

### Day 6-7: APIClient + Backend é›†æˆï¼ˆä» Week 1 Day 5 æ¨è¿Ÿï¼‰

**ä»»åŠ¡**:
- [ ] åˆ›å»º APIClientï¼ˆURLSession + async/awaitï¼‰
- [ ] å®ç° SecurityInterceptorï¼ˆé›†æˆå®¡è®¡æ—¥å¿—ã€é€Ÿç‡é™åˆ¶ï¼‰
- [ ] è¿æ¥ FastAPI Backendï¼ˆhttp://localhost:8000ï¼‰
- [ ] é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶
- [ ] é›†æˆæµ‹è¯•ï¼ˆFrontend â†” Backendï¼‰

**äº¤ä»˜ç‰©**: APIClient.swift + SecurityInterceptor.swift

**ä¼˜å…ˆçº§**: P0ï¼ˆWeek 1 Day 5 æ¨è¿Ÿä»»åŠ¡ï¼‰

**è¯´æ˜**:
- **åŸè®¡åˆ’çš„"æ™ºèƒ½åœºæ™¯è¯†åˆ«"å·²åœ¨ Week 1 Day 4-5 æå‰å®Œæˆ** âœ…
- å®é™…å®ç°ï¼šSceneDetector.swiftï¼ˆ250 è¡Œï¼‰
- å®Œæˆå†…å®¹ï¼š
  - Accessibility API é›†æˆï¼ˆçª—å£æ ‡é¢˜æ£€æµ‹ï¼‰
  - NSWorkspace API é›†æˆï¼ˆæ´»åŠ¨åº”ç”¨æ£€æµ‹ï¼‰
  - 6 ç§åœºæ™¯è¯†åˆ«ï¼ˆbrowsing, coding, writing, reading, meeting, unknownï¼‰
  - ç½®ä¿¡åº¦è®¡ç®—ï¼ˆ0.5-0.95ï¼‰
  - 40+ åº”ç”¨è§„åˆ™åº“
- å‚è€ƒï¼šWeek 1 Day 4-5 å®é™…å®Œæˆéƒ¨åˆ†ï¼ˆè¡Œ 318-340ï¼‰

**åç»­å¢å¼ºæ–¹å‘**ï¼ˆå¯é€‰ï¼Œé P0ï¼‰:
- [ ] æ–‡æœ¬é€‰æ‹©ç›‘å¬ï¼ˆNSEvent.addGlobalMonitorForEventsï¼‰
- [ ] å‰ªè´´æ¿å˜åŒ–ç›‘å¬ï¼ˆNSPasteboard.changeCountï¼‰
- [ ] è‡ªåŠ¨æ¨è Patternï¼ˆåŸºäºé€‰ä¸­æ–‡æœ¬å†…å®¹ï¼‰
- [ ] æ–‡ä»¶æ‹–æ‹½åœºæ™¯è¯†åˆ«

---

### Day 8-9: æ¸è¿›å¼ä¿¡ä»»æœºåˆ¶

**ä»»åŠ¡**:
- [ ] å®ç° TrustEngineï¼ˆRisk Level 0-3ï¼‰
- [ ] è®¾è®¡é£é™©è¯„ä¼°è§„åˆ™
- [ ] é›†æˆ Policy Engineï¼ˆå¤ç”¨ Phase 1.5ï¼‰
- [ ] UI é£é™©æç¤ºï¼ˆRiskBadgeï¼‰

**äº¤ä»˜ç‰©**: TrustEngine.swift + RiskBadge.swift

**é£é™©ç­‰çº§å®šä¹‰**:
```swift
// RiskLevel.swift
enum RiskLevel: Int, Comparable {
    case r0_safe = 0        // å®‰å…¨ï¼šåªè¯»æ“ä½œ
    case r1_low = 1         // ä½é£é™©ï¼šæ–‡æœ¬å¤„ç†
    case r2_medium = 2      // ä¸­é£é™©ï¼šæ–‡ä»¶è¯»å–
    case r3_high = 3        // é«˜é£é™©ï¼šæ–‡ä»¶å†™å…¥/ç½‘ç»œè¯·æ±‚

    var color: Color {
        switch self {
        case .r0_safe: return .green
        case .r1_low: return .blue
        case .r2_medium: return .orange
        case .r3_high: return .red
        }
    }

    var requiresConfirmation: Bool {
        self >= .r2_medium
    }
}

// TrustEngine.swift
@Observable
class TrustEngine {
    private let policyEngine: PolicyEngine  // Phase 1.5

    func assessRisk(for task: Task) -> RiskLevel {
        var risk: RiskLevel = .r0_safe

        // è§„åˆ™ 1: æ“ä½œç±»å‹
        if task.pattern == .format || task.pattern == .translate {
            risk = .r1_low  // æ–‡æœ¬å¤„ç†
        } else if task.pattern == .search {
            risk = .r3_high  // ç½‘ç»œè¯·æ±‚
        }

        // è§„åˆ™ 2: è¾“å…¥æ¥æº
        if task.source == .file {
            risk = max(risk, .r2_medium)  // æ–‡ä»¶è¯»å–
        }

        // è§„åˆ™ 3: è¾“å‡ºç›®æ ‡
        if task.outputTarget == .file {
            risk = .r3_high  // æ–‡ä»¶å†™å…¥
        }

        // Phase 1.5 Policy Engine éªŒè¯
        if !policyEngine.isAllowed(task) {
            risk = .r3_high
        }

        return risk
    }

    func requestConfirmation(for task: Task) async -> Bool {
        let risk = assessRisk(for: task)
        guard risk.requiresConfirmation else { return true }

        // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
        return await showConfirmationDialog(task: task, risk: risk)
    }
}
```

**éªŒæ”¶**:
- âœ… R0-R3 é£é™©è¯„ä¼°å‡†ç¡®
- âœ… R2+ æ“ä½œéœ€è¦ç”¨æˆ·ç¡®è®¤
- âœ… UI é£é™©æ ‡è¯†æ¸…æ™°
- âœ… é›†æˆ Phase 1.5 Policy Engine

---

### Day 10: ä¸€é”®æ’¤é”€ç³»ç»Ÿ

**ä»»åŠ¡**:
- [ ] å®ç° UndoManagerï¼ˆ7 å¤©å†…å¯å›æ»šï¼‰
- [ ] æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†ï¼ˆå¿«ç…§å­˜å‚¨ï¼‰
- [ ] UI æ’¤é”€æŒ‰é’®ä¸å†å²è®°å½•
- [ ] è‡ªåŠ¨æ¸…ç†è¿‡æœŸå¿«ç…§

**äº¤ä»˜ç‰©**: UndoManager.swift + UndoSnapshot.swift

**æ ¸å¿ƒåŠŸèƒ½**:
```swift
// UndoSnapshot.swift
struct UndoSnapshot: Codable, Identifiable {
    let id: UUID
    let taskID: UUID
    let timestamp: Date
    let originalContent: Data
    let modifiedContent: Data
    let filePath: URL?

    var isExpired: Bool {
        Date().timeIntervalSince(timestamp) > 7 * 24 * 3600  // 7 å¤©
    }
}

// UndoManager.swift
actor UndoManager {
    private let snapshotDirectory: URL
    private var snapshots: [UndoSnapshot] = []

    init() {
        self.snapshotDirectory = FileManager.default
            .urls(for: .applicationSupportDirectory, in: .userDomainMask)[0]
            .appendingPathComponent("MacCortex/Snapshots")

        try? FileManager.default.createDirectory(
            at: snapshotDirectory,
            withIntermediateDirectories: true
        )

        // åŠ è½½ç°æœ‰å¿«ç…§
        loadSnapshots()
    }

    func createSnapshot(for task: Task, originalContent: Data) async throws {
        let snapshot = UndoSnapshot(
            id: UUID(),
            taskID: task.id,
            timestamp: Date(),
            originalContent: originalContent,
            modifiedContent: task.result?.data ?? Data(),
            filePath: task.outputTarget == .file ? task.outputURL : nil
        )

        // ä¿å­˜å¿«ç…§åˆ°ç£ç›˜
        try await saveSnapshot(snapshot)
        snapshots.append(snapshot)
    }

    func undo(snapshotID: UUID) async throws {
        guard let snapshot = snapshots.first(where: { $0.id == snapshotID }) else {
            throw UndoError.snapshotNotFound
        }

        // æ¢å¤åŸå§‹å†…å®¹
        if let filePath = snapshot.filePath {
            try snapshot.originalContent.write(to: filePath)
        }

        // åˆ é™¤å¿«ç…§
        try await deleteSnapshot(snapshot)
        snapshots.removeAll { $0.id == snapshotID }
    }

    func cleanupExpiredSnapshots() async {
        let expired = snapshots.filter { $0.isExpired }
        for snapshot in expired {
            try? await deleteSnapshot(snapshot)
        }
        snapshots.removeAll { $0.isExpired }
    }
}
```

**éªŒæ”¶**:
- âœ… æ–‡ä»¶æ“ä½œå‰è‡ªåŠ¨åˆ›å»ºå¿«ç…§
- âœ… 7 å¤©å†…å¯ä¸€é”®å›æ»š
- âœ… è¿‡æœŸå¿«ç…§è‡ªåŠ¨æ¸…ç†
- âœ… å­˜å‚¨å¼€é”€ < 100MBï¼ˆæ­£å¸¸ä½¿ç”¨ï¼‰

---

## Week 3: UI å®Œå–„ + é›†æˆæµ‹è¯•ï¼ˆDay 11-15ï¼‰

### Day 11-12: å†å²è®°å½•ä¸è®¾ç½®

**ä»»åŠ¡**:
- [ ] å®ç° HistoryViewï¼ˆä»»åŠ¡å†å²ï¼‰
- [ ] å®ç° SettingsViewï¼ˆåº”ç”¨è®¾ç½®ï¼‰
- [ ] SwiftData æŒä¹…åŒ–
- [ ] æœç´¢ä¸è¿‡æ»¤åŠŸèƒ½

**äº¤ä»˜ç‰©**: HistoryView.swift + SettingsView.swift

---

### Day 13-14: é›†æˆæµ‹è¯•

**ä»»åŠ¡**:
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆUI â†’ Backend â†’ å®‰å…¨æ¨¡å—ï¼‰
- [ ] æ€§èƒ½æµ‹è¯•ï¼ˆUI å“åº”æ—¶é—´ < 100msï¼‰
- [ ] æƒé™æµ‹è¯•ï¼ˆFull Disk Accessï¼‰
- [ ] æ’¤é”€ç³»ç»Ÿæµ‹è¯•

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰ 5 ä¸ª Pattern æ­£å¸¸å·¥ä½œ
- âœ… Phase 1.5 å®‰å…¨æ¨¡å—é›†æˆæ— è¯¯
- âœ… UI å“åº”æ—¶é—´ < 100ms p95
- âœ… æ’¤é”€æˆåŠŸç‡ 100%

---

### Day 15: æ–‡æ¡£ä¸å‘å¸ƒå‡†å¤‡

**ä»»åŠ¡**:
- [ ] æ›´æ–° README.mdï¼ˆPhase 2 å®Œæˆï¼‰
- [ ] åˆ›å»ºç”¨æˆ·æ‰‹å†Œ
- [ ] ç”Ÿæˆç­¾å DMG
- [ ] å…¬è¯æµ‹è¯•

**äº¤ä»˜ç‰©**: MacCortex-v1.0.dmg

---

## Phase 2 éªŒæ”¶æ ‡å‡†ï¼ˆP0 é˜»å¡æ€§ï¼‰

| # | éªŒæ”¶é¡¹ | æµ‹è¯•æ–¹æ³• | æœŸæœ›ç»“æœ | ä¼˜å…ˆçº§ |
|---|--------|----------|----------|--------|
| 1 | **Desktop GUI å¯ç”¨æ€§** | æ‰‹åŠ¨æµ‹è¯• | æ‰€æœ‰ 5 ä¸ª Pattern æ­£å¸¸å·¥ä½œ | P0 |
| 2 | **åœºæ™¯è¯†åˆ«å‡†ç¡®ç‡** | 100 ä¸ªåœºæ™¯æµ‹è¯• | â‰¥ 85% å‡†ç¡®ç‡ | P0 |
| 3 | **ä¿¡ä»»æœºåˆ¶æœ‰æ•ˆæ€§** | é£é™©è¯„ä¼°æµ‹è¯• | R2+ æ“ä½œéœ€ç¡®è®¤ | P0 |
| 4 | **æ’¤é”€æˆåŠŸç‡** | 50 æ¬¡æ’¤é”€æµ‹è¯• | 100% æˆåŠŸç‡ | P0 |
| 5 | **UI å“åº”æ—¶é—´** | æ€§èƒ½åŸºå‡†æµ‹è¯• | < 100ms p95 | P0 |
| 6 | **Phase 1.5 å®‰å…¨é›†æˆ** | é›†æˆæµ‹è¯• | å®¡è®¡æ—¥å¿—ã€é€Ÿç‡é™åˆ¶æ­£å¸¸ | P0 |

**é€šè¿‡æ¡ä»¶**: æ‰€æœ‰ 6 é¡¹å¿…é¡» âœ…

---

## å…³é”®æŠ€æœ¯å†³ç­–

### å†³ç­– 1: Observation Framework vs Combine

**é—®é¢˜**: SwiftUI çŠ¶æ€ç®¡ç†é€‰æ‹©å“ªç§æ–¹æ¡ˆï¼Ÿ

**é€‰é¡¹**:
- **æ–¹æ¡ˆ A**: Observation Frameworkï¼ˆSwift 5.9+ï¼‰
- **æ–¹æ¡ˆ B**: Combineï¼ˆä¼ ç»Ÿæ–¹æ¡ˆï¼‰
- **æ–¹æ¡ˆ C**: æ··åˆä½¿ç”¨

**å»ºè®®**: **æ–¹æ¡ˆ A** - Observation Framework

**ç†ç”±**:
- macOS 14+ åŸç”Ÿæ”¯æŒï¼Œæ›´ç®€æ´çš„ API
- æ›´å¥½çš„æ€§èƒ½ï¼ˆç¼–è¯‘å™¨ä¼˜åŒ–ï¼‰
- è‡ªåŠ¨ä¾èµ–è¿½è¸ªï¼ˆæ— éœ€æ‰‹åŠ¨ @Publishedï¼‰
- ç¬¦åˆ Apple æœ€æ–°æŠ€æœ¯æ–¹å‘

---

### å†³ç­– 2: æµ®åŠ¨å·¥å…·æ  vs èœå•æ åº”ç”¨

**é—®é¢˜**: ä¸»ç•Œé¢å½¢æ€é€‰æ‹©ï¼Ÿ

**é€‰é¡¹**:
- **æ–¹æ¡ˆ A**: æµ®åŠ¨å·¥å…·æ ï¼ˆApple Intelligence é£æ ¼ï¼‰
- **æ–¹æ¡ˆ B**: èœå•æ åº”ç”¨ï¼ˆRaycast é£æ ¼ï¼‰
- **æ–¹æ¡ˆ C**: ä¼ ç»Ÿçª—å£åº”ç”¨

**å»ºè®®**: **æ–¹æ¡ˆ A** - æµ®åŠ¨å·¥å…·æ 

**ç†ç”±**:
- ç¬¦åˆ"éšå½¢ AI"è®¾è®¡ç†å¿µ
- å¿«æ·é”®è§¦å‘ï¼Œå³ç”¨å³èµ°
- è§†è§‰ä¸Šæ›´ç°ä»£åŒ–
- æ”¯æŒæ‹–æ‹½å®šä½

---

### å†³ç­– 3: SwiftData vs Core Data

**é—®é¢˜**: æŒä¹…åŒ–æ–¹æ¡ˆé€‰æ‹©ï¼Ÿ

**é€‰é¡¹**:
- **æ–¹æ¡ˆ A**: SwiftDataï¼ˆSwift åŸç”Ÿï¼‰
- **æ–¹æ¡ˆ B**: Core Dataï¼ˆObjective-Cï¼‰

**å»ºè®®**: **æ–¹æ¡ˆ A** - SwiftData

**ç†ç”±**:
- macOS 14+ åŸç”Ÿæ”¯æŒ
- Swift åŸç”Ÿ APIï¼Œç±»å‹å®‰å…¨
- è‡ªåŠ¨ç”Ÿæˆ Schema
- ä¸ Observation Framework æ— ç¼é›†æˆ

---

## é£é™©ä¸ç¼“è§£

| é£é™© | æ¦‚ç‡ | å½±å“ | ç¼“è§£ç­–ç•¥ | æ®‹ä½™é£é™© |
|------|------|------|----------|----------|
| **Accessibility API æƒé™è¢«æ‹’** | 20% | é«˜ | ä¼˜é›…é™çº§ï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰ | ğŸŸ¡ ä¸­ |
| **æ€§èƒ½ä¸è¾¾æ ‡** | 15% | ä¸­ | å¼‚æ­¥å¤„ç† + ç¼“å­˜ | ğŸŸ¢ ä½ |
| **æ’¤é”€å¤±è´¥** | 10% | é«˜ | å®Œæ•´æµ‹è¯• + äº‹åŠ¡æœºåˆ¶ | ğŸŸ¢ ä½ |
| **åœºæ™¯è¯†åˆ«è¯¯æŠ¥** | 30% | ä½ | æ‰‹åŠ¨é€‰æ‹© Pattern | ğŸŸ¢ ä½ |
| **Backend è¿æ¥å¤±è´¥** | 5% | é«˜ | ç¦»çº¿æ¨¡å¼ + é”™è¯¯æç¤º | ğŸŸ¢ ä½ |

**æ€»ä½“é£é™©è¯„åˆ†**: ğŸŸ¢ **å¯æ§**

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼ˆWeek 2 ç«‹å³å¼€å§‹ï¼‰

### Week 2 Day 6-7: APIClient + Backend é›†æˆ

**å‡†å¤‡å·¥ä½œ**:
```bash
# 1. éªŒè¯ Week 1 å®ŒæˆçŠ¶æ€
cd /Users/jamesg/projects/MacCortex
git log --oneline --since="2026-01-21" --until="2026-01-22"
# é¢„æœŸ: 3 ä¸ªæäº¤ï¼ˆfac38e4, 01c74c1, 6cb969cï¼‰

# 2. å¯åŠ¨ Phase 1.5 Backend
cd Backend && source .venv/bin/activate
python -m uvicorn src.main:app --reload &

# 3. æµ‹è¯• Backend API å¯ç”¨æ€§
curl -X POST http://localhost:8000/execute -d '{
  "pattern_id": "summarize",
  "text": "Week 2 Backend é›†æˆæµ‹è¯•",
  "parameters": {"length": "short"}
}'
# é¢„æœŸ: 200 OK + JSON å“åº”

# 4. éªŒè¯ Phase 1.5 å®‰å…¨æ¨¡å—
cat Backend/logs/audit-$(date +%Y-%m-%d).jsonl | tail -1 | jq .
# é¢„æœŸ: å®¡è®¡æ—¥å¿—è®°å½•æ­£å¸¸
```

**å®æ–½æ­¥éª¤**:
1. åˆ›å»º `Sources/MacCortexApp/Network/APIClient.swift`
2. åˆ›å»º `Sources/MacCortexApp/Network/SecurityInterceptor.swift`
3. åˆ›å»º `Sources/MacCortexApp/Network/Endpoints.swift`
4. æ›´æ–° `AppState.swift` é›†æˆ APIClient
5. æ›´æ–° `FloatingToolbarView.swift` è°ƒç”¨çœŸå® API
6. é›†æˆæµ‹è¯•ï¼ˆFrontend â†’ Backend â†’ å®¡è®¡æ—¥å¿—ï¼‰
7. é”™è¯¯å¤„ç†ä¸ç”¨æˆ·æç¤º
8. Git æäº¤ï¼ˆWeek 2 Day 6-7ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- âœ… APIClient å¯æ­£å¸¸è°ƒç”¨ 5 ä¸ª Pattern
- âœ… SecurityInterceptor é›†æˆå®¡è®¡æ—¥å¿— + é€Ÿç‡é™åˆ¶
- âœ… é”™è¯¯å¤„ç†å‹å¥½ï¼ˆç½‘ç»œé”™è¯¯ã€é€Ÿç‡é™åˆ¶ã€Backend å¼‚å¸¸ï¼‰
- âœ… UI æ˜¾ç¤ºå®é™… Pattern æ‰§è¡Œç»“æœ
- âœ… ç¼–è¯‘æ— é”™è¯¯ï¼Œè¿è¡Œæ— å´©æºƒ

---

**è®¡åˆ’çŠ¶æ€**: âœ… Week 1 å·²å®Œæˆï¼Œâ³ Week 2 å¾…å¯åŠ¨
**åˆ›å»ºæ—¶é—´**: 2026-01-21
**æœ€åæ›´æ–°**: 2026-01-21ï¼ˆWeek 1 å®Œæˆï¼‰
**åŸºäº**: Phase 1.5 å®ŒæˆçŠ¶æ€ + README_ARCH.md v1.1
**æ‰§è¡Œäºº**: Claude Code (Sonnet 4.5)
**éªŒè¯æ–¹å¼**: 6 é¡¹ P0 éªŒæ”¶æ ‡å‡†
